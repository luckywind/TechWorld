# 课题

## 如何搭建数仓，全流程说一下

[知乎](https://www.zhihu.com/question/19703294)

### 是什么？

其实很多企业做数据仓库的时候，都忽略了数仓与BI、数据库的差异，只去搞底层数据，不去做数据服务和应用，其实就是把数据仓库给狭义化了。数据仓库可以看成是BI的基础版本、数据库的升级版本。

数据仓库的本质，其实就是**整合多个数据源的历史数据进行细粒度的、多维的分析，帮助高层管理者或者业务分析人员做出商业战略决策或商业报表。**

4个层次

- ODS层：存放原始数据，直接加载原始日志、数据，数据保存原貌不做处理。
- DWD层：结构与粒度原始表保持一致，对ODS层数据进行清洗
- DWS层：以DWD为基础，进行轻度汇总
- ADS层：为各种统计报表提供数据

### 数据建模，怎么做

1.首先我们应该确认数据仓库的主题，模型的建立均要以建立好的主题为准，而不是力图建设一个适合于所有主题的模型

2.在确定主题之后，我们需要从两个角度考虑这个主题，维度和指标。维度和指标不是随意定的，而是经过慎重考虑，两者如何联系起来，如何体现主题。

3.在确定了维度和指标后，我们需要考虑，维度和指标也需要根据某些相关性，将数据划分成相对主题的表。例如，用户维度，可以划分为基本信息、消费信息等表。指标也是如此

4.建立一张事实表，去把维度和指标联系起来，这张可以做成一张大宽表



## 数仓分层、主题域、建模流程

数仓分层，一般是:

1. ods原始数据层，也叫贴源层，保留原始数据，不做处理，且保留时间比较长

   > 小米在ods 上又搞了个同粒度的transform层
2. dwd层，对ods层数据进行清洗，结构和粒度和原始表保持一致
3. dws层，以dwd为基础，进行轻度汇总，一般按天汇总。
4. ads层，为各种统计报表提供数据
5. app 层主要存放一些相对成熟的表，能供业务侧使用的

### 主题：

主题（Subject）是在较高层次上将企业信息系统中的数据进行综合、归类和分析利用的一个抽象概念，每一个主题基本对应一个<font color=red>**宏观的分析领域**</font>。在逻辑意义上，它是对应企业中某一宏观分析领域所涉及的分析对象。例如“销售分析”就是一个分析领域，因此这个数据仓库应用的主题就是“销售分析”。

### 主题域

主题域通常是**联系较为紧密**的数据**主题的集合**

主题域下面可以有多个主题，主题还可以划分成更多的子主题，而实体则是不可划分的最小单位。主题域、主题、实体的关系如下图所示

![img](https://piggo-picture.oss-cn-hangzhou.aliyuncs.com/image/v2-06a665dc0c2afa830738c3f10a4d65a9_1440w.jpg)



[参考华为云上的回答](https://www.huaweicloud.com/articles/432adc9ebe5d354c6393a3490a005d10.html)

关于主题域的另外一个定义方式：“主题域是对某个主题进行分析后确定的<font color=red>主题的边界</font>”

例如：根据业务情况确定的分析主题

<img src="https://piggo-picture.oss-cn-hangzhou.aliyuncs.com/image/f8ff1d61f1d89f260846c4ca8ea278501603778488991.png" alt="数据仓库、主题域、主题概念与定义2" style="zoom:150%;" />

确定主题边界实际上需要**进一步理解业务关系**，因此在确定整个分析主题后，还需要对这些主题进行初步的细化才便于获取每一个主题应该具有的边界。

主题域的划分：

![数据仓库、主题域、主题概念与定义3](https://piggo-picture.oss-cn-hangzhou.aliyuncs.com/image/65625cf018dacb8ca0b5896c1d2b82a71603778488991.png)

发现此定义与：”主题域通常是**联系较为紧密**的***数据\*主题的集合**“并不矛盾，只是所站的视角不同，“数据主题集合”的观点从数据着眼，前提是已经经过分析、梳理列出所有可能的数据主题，此处数据主题是细粒度的，是从微观到宏观；“边界论”的观点中，某个主题是分析的主题，是宏观概念，而非数据主题。

#### 主题域的划分

**主题域的确定必须由最终用户和数据仓库的设计人员共同完成的， 而在划分主题域时，大家的切入点不同可能会造成一些争论、重构等的现象，考虑的点可能会是下方的某些方面：**

1. 按照业务或者业务过程划分
2. 按照需求方划分
3. 按照功能或应用划分
4. 按照部门划分

总而言之，切入的出发点逻辑不一样，就可以存在不同的划分逻辑。在建设过程中可采用迭代方式，不纠结于一次完成所有主题的抽象，可先从明确定义的主题开始，后续逐步归纳总结成自身行业的标准模型。







## 数仓团队如何分工的，职责可否再优化

## 你最擅长的业务模板讲一下

## 你经历过最复杂的业务场景讲一下

## 埋点、流量域如何建设的

## 元数据和数据血缘的关系，你们是如何做元数据管理的，详细说下

## 熟悉的调度系统选型对比，依赖触发和时间触发的优缺点

## 熟悉的BI报表工具选型对比

## olap用的哪个组件，适用场景

## 数据质量全面展开说下，如何做的，dqc如何保证，sla如何保障与优化手段

## 目前数仓存在的问题与痛点，可以从业务、模型、技术多个方向展开说下

## 用户画像如何做的

## sqoop同步数据遇到数据倾斜怎么处理，或有没有替代方案

## hive数据倾斜的原因、场景与解决方案

## hive优化方式有哪些

## 如何确定map数、reduce数

## cube、grouping sets、grouping__id

## 数据量级、表/任务量级、集群量级

## 实时数仓做过吗，可简单说一下

## 给一个业务场景，让现场模型设计，基于模型又写了3个SQL（主要考察分析函数）

## 为什么离职，期望一个什么样的团队

## 工作中你最出色的产出是什么

## 以后如何职业规划与未来发展
