# 类型使用

第五章讨论了基本的DataFrame概念和抽象，本文会覆盖表达式的构建，回顾不同类型数据的使用

1. Boolean
2. Numbers
3. Strings
4. Dates 和timestamps
5. null值处理
6. 复杂类型
7. UDF

## 转成spark类型

```scala
val df = spark.read.format("csv")
  .option("header", "true")
  .option("inferSchema", "true")
  .load("data/retail-data/by-day/2010-12-01.csv")
df.printSchema()
df.createOrReplaceTempView("dfTable")
```



lit函数会把类型转成它对应的spark表示。

```scala
import org.apache.spark.sql.functions.lit
scala> df.select(lit(5), lit("five"), lit(5.0)).show(2)
+---+----+---+
|  5|five|5.0|
+---+----+---+
|  5|five|5.0|
|  5|five|5.0|
+---+----+---+
```

## bool使用

布尔语句由四个元素组成and、or、true和false。

```scala

import org.apache.spark.sql.functions.col
df.where(col("InvoiceNo").equalTo(536365))
  .select("InvoiceNo", "Description")
  .show(5, false)
+---------+-----------------------------------+
|InvoiceNo|Description                        |
+---------+-----------------------------------+
|536365   |WHITE HANGING HEART T-LIGHT HOLDER |
|536365   |WHITE METAL LANTERN                |
|536365   |CREAM CUPID HEARTS COAT HANGER     |
|536365   |KNITTED UNION FLAG HOT WATER BOTTLE|
|536365   |RED WOOLLY HOTTIE WHITE HEART.     |
+---------+-----------------------------------+
```

注意，在spark中，如果想要使用相等，应该使用===和=!=，也可以使用not函数和equalTo方法

```scala
import org.apache.spark.sql.functions.col
df.where(col("InvoiceNo") === 536365)
  .select("InvoiceNo", "Description")
  .show(5, false)
```

