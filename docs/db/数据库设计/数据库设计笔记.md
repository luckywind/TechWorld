[参考](http://www.geeksengine.com/database/design/normalization.php)

# 数据库规范化

1. 第一个NF：唯一标识符，原子数据，无重复列。
2. 第二个NF：删除对复合主键的部分依赖。
3. 3rd NF：删除对非主键列的传递依赖。

# 通过数据约束加强数据完整性

## 完整性

**数据完整性**是指存储在数据库中的数据的准确性，一致性和可靠性

## **数据完整性的类型**

数据完整性有四种类型：

1. 行完整性

行完整性是指要求表中的所有行必须具有唯一的标识符，该标识符可用于区分每条记录。此唯一标识符通常称为表的主键。主键可以由单列或多列组合形成。

2. 列完整性

列完整性是指对存储在列中的数据必须遵守相同格式和定义的要求。这包括数据类型，数据长度，数据默认值，可能值的范围，是否允许重复值或是否允许空值。

3. 参照完整性

参照完整性是在数据库设计时定义的，并通过在表之间创建表关系来实施

4. 用户定义的完整性

某些应用程序具有复杂的业务逻辑

## 约束

数据库约束是定义表结构的声明性完整性规则。它们包括以下7种约束类型：



1. 数据类型约束：

   这定义了数据的类型，数据长度以及其他一些与列中的数据类型具体相关的属性。

2. 默认约束：

   这定义了在表中插入记录时未显式提供任何值时，列应使用的值。

3. 可空性约束：

   这定义了列是非空还是允许将空值存储在其中。

4. 主键约束：

   这是表的唯一标识符。每行必须具有不同的值。主键可以是顺序递增的整数，也可以是代表现实世界中发生的情况的自然选择的数据（例如，社会安全号码）。主键值中不允许使用NULL值。

5. 唯一约束：

   这定义了列中的值必须唯一，并且不应存储任何重复项。

   有时即使列不充当表的主键，列中的数据也必须是唯一的。例如，CategoryName列在Categories表中是唯一的，但是CategoryName不是表的主键。

6. 外键约束：

   这定义了如何在两个表之间实施引用完整性。

7. 检查约束：

   这为列中的数据值定义了验证规则，因此它是用户定义的数据完整性约束。用户在设计表中的列时定义此规则。并非每个数据库引擎都支持检查约束。从5.0版开始，MySQL不支持检查约束。但是，您可以使用enum数据类型或set数据类型来实现其某些其他关系数据库管理系统（Oracle，SQL Server等）中可用的功能。

| 数据完整性类型   | 受数据库约束强制                                       |
| ---------------- | ------------------------------------------------------ |
| 行完整性         | 主键约束，唯一约束                                     |
| 列完整性         | 外键约束，检查约束，默认约束，数据类型约束，可空性约束 |
| 参照完整性       | 外键约束                                               |
| 用户定义的完整性 | 检查约束                                               |

## 实施数据库约束

### 主键约束和唯一约束

- 当您在表上创建主键时，会自动隐式创建一个唯一索引（并因此创建唯一约束），从而强制此列中的数据唯一。
- 主键列不能包含NULL值。数据库引擎在主键列上隐式创建一个NOT NULL约束。
- 一个表只能在其上定义一个主键。
- 主键可以由单列或由多列组成（即复合主键）。
- 如果在主键中插入重复的记录，则会出现错误。

主键有两种类型：人工主键和自然主键。

**人工主键**是一个整数，它由MySQL数据库引擎自动生成，自动递增和维护。这是定义和创建主键的首选方式。人工主键也称为代理主键。

**自然主键**采用数据的自然格式，并且通常具有与之相关的业务含义。自然主键也称为智能主键。

**注意：**推荐使用人工主键，原因如下：

- 整数值独立于业务需求，业务需求经常不时变化。

  这实际上是使用自然主键的缺点。当组织进行功能更改时，主键值也会更改。人工主键不会遇到此问题，因为整数值没有业务含义，也不与业务更改相关。

- 使用整数值作为主键通常可以提高查询性能。

## 外键关系注意事项

外键关系强制引用完整性，被引用的表的主键如果被记录参照，则不能删除

被引用表中不存在的键，引用表中无法添加该键对应的记录

