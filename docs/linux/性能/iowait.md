[参考](https://linuxblog.io/what-is-iowait-and-linux-performance/)

定义：CPU在系统阻塞磁盘IO请求期间idle的时间百分比，I/O wait = time waiting for I/O completion。  I/O 等待的存在告诉我们系统在可以处理未完成的请求时处于空闲状态



cpu状态：

- **us** (user).
- **sy** (system).
- **id** (idle).
- **ni** (nice).
- **si** (software interrupts).
- **hi** (hardware interrupts).
- **st** (steal).
- **wa** (wait).

其中，“user”、“system”、“idle”和“wait”值加起来应为 100%。请注意，“idle”和“wait”并不相同。 “空闲”CPU 表示不存在工作负载，而“等待”(iowait) 表示 CPU 何时处于空闲状态等待未完成/正在等待的请求。

如果 CPU 空闲，内核将确定源自 CPU 的任何待处理 I/O 请求（即 NVMe 或 NAS）。如果有，则“iowait”计数器递增。如果没有任何待处理的内容，则“空闲”计数器会增加。

监控并减少IO wait相关问题

```shell
iostat -xdk 2  
Linux 3.10.0-1160.el7.x86_64 (server66)         12/28/2023      _x86_64_        (32 CPU)

Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
nvme1n1           0.00     0.19    6.54   10.52   733.57  2265.62   351.55     0.28   16.26    1.26   25.57   0.11   0.19
nvme0n1           1.13     0.72   15.90    7.46  2940.04  1241.76   358.01     0.72   24.17    6.99   60.77   0.65   1.53
sda               0.00     0.02    0.43    0.24    55.05   122.09   526.27     0.11  167.73    9.63  449.39   2.28   0.15
dm-0              0.00     0.00    0.94    2.41    55.25   565.08   370.33     0.78  230.85    2.96  319.53   2.52   0.85
dm-1              0.00     0.00    0.70    1.32     2.79     5.29     8.00     0.70  341.78    5.46  518.76   0.47   0.10
dm-2              0.00     0.00   21.93   14.35  3615.57  2937.01   361.25     0.86   23.47    5.53   50.88   0.35   1.27
dm-3              0.00     0.00    0.43    0.26    55.05   122.09   512.09     0.13  192.75   10.21  497.58   2.22   0.15
```

%util: 暗示了设备的繁忙程度

高 iowait 并不总是表明存在问题，因为现代存储解决方案本质上可能比 CPU 性能慢。关键是进一步调查并评估对最终用户体验、数据库查询和整体应用程序运行状况的影响。