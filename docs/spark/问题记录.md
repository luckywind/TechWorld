File does not exist. Holder DFSClient_does not have any open files

[hdfs超租约异常](https://www.cnblogs.com/wangxiaowei/p/3317479.html)

# 读取parquet失败

```scala
  val frame: DataFrame = spark.read.parquet(idMappingConfig.DWM_DVC_DEVICE_CHAIN + suffix) //.na.drop()
   val res: DataFrame = frame.select("origin_device_id", "user_id", "start_day", "prod_cat_name", "sn", "del_flg").na.fill("")
        res.rdd.map {
                    case Row(origin_device_id: String,user_id: Long,start_day: Long,prod_cat_name: String,sn: String,del_flg: Int) => {
                        DVC_OT_CHAIN(origin_device_id, user_id, start_day.toString, prod_cat_name, end_day, sn, del_flg)
                    }
                }
```

# UncheckedCompileException

[参考](https://newbedev.com/spark-sql-fails-with-java-lang-noclassdeffounderror-org-codehaus-commons-compiler-uncheckedcompileexception)

# NoSuchMethodError: org.apache.parquet.schema.Types$MessageTypeBuilder.addFields

com.twitter的parquet jar代替了hive的，[排除](https://cdap.atlassian.net/browse/CDAP-7082?page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel)

# java.lang.NoSuchMethodError: scala.Product.$init$(Lscala/Product;)V

Scala/spark/spark-sql的版本不匹配

Idl

# 找不到类

1. 尝试include dependency

![image-20220311171321755](https://gitee.com/luckywind/PigGo/raw/master/image/image-20220311171321755.png)

# java.lang.IllegalStateException: User did not initialize spark context!

去掉setMaster(local)

# parquet类型不匹配

 java.lang.UnsupportedOperationException: org.apache.parquet.column.values.dictionary.PlainValuesDictionary$PlainLongDictionary

parquet有个字段类型是Long,但是表的字段类型是String，导致查询失败

# AbstractMethodError

通常是spark-core版本不匹配

